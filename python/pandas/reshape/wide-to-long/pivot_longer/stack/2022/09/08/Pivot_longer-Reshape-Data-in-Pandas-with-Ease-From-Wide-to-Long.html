<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Pivot_longer : Reshape Data in Pandas Efficiently and with Ease from Wide to Long | Samuel Oranyeli</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Pivot_longer : Reshape Data in Pandas Efficiently and with Ease from Wide to Long" />
<meta name="author" content="Samuel Oranyeli" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reshaping Data Efficiently and with Ease" />
<meta property="og:description" content="Reshaping Data Efficiently and with Ease" />
<link rel="canonical" href="https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html" />
<meta property="og:url" content="https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html" />
<meta property="og:site_name" content="Samuel Oranyeli" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-08T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Samuel Oranyeli"},"description":"Reshaping Data Efficiently and with Ease","@type":"BlogPosting","headline":"Pivot_longer : Reshape Data in Pandas Efficiently and with Ease from Wide to Long","dateModified":"2022-09-08T00:00:00-05:00","url":"https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html","datePublished":"2022-09-08T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/data-wrangling-blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://samukweku.github.io/data-wrangling-blog/feed.xml" title="Samuel Oranyeli" /><link rel="shortcut icon" type="image/x-icon" href="/data-wrangling-blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Pivot_longer : Reshape Data in Pandas Efficiently and with Ease from Wide to Long | Samuel Oranyeli</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Pivot_longer : Reshape Data in Pandas Efficiently and with Ease from Wide to Long" />
<meta name="author" content="Samuel Oranyeli" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reshaping Data Efficiently and with Ease" />
<meta property="og:description" content="Reshaping Data Efficiently and with Ease" />
<link rel="canonical" href="https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html" />
<meta property="og:url" content="https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html" />
<meta property="og:site_name" content="Samuel Oranyeli" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-08T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Samuel Oranyeli"},"description":"Reshaping Data Efficiently and with Ease","@type":"BlogPosting","headline":"Pivot_longer : Reshape Data in Pandas Efficiently and with Ease from Wide to Long","dateModified":"2022-09-08T00:00:00-05:00","url":"https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html","datePublished":"2022-09-08T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://samukweku.github.io/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://samukweku.github.io/data-wrangling-blog/feed.xml" title="Samuel Oranyeli" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script type="text/javascript">
require.config({
  paths: {
    jquery: 'https://code.jquery.com/jquery-3.5.0.min',
    plotly: 'https://cdn.plot.ly/plotly-latest.min'
  },

  shim: {
    plotly: {
      deps: ['jquery'],
      exports: 'plotly'
    }
  }
});
</script>

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/data-wrangling-blog/">Samuel Oranyeli</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/data-wrangling-blog/about/">About Me</a><a class="page-link" href="/data-wrangling-blog/search/">Search</a><a class="page-link" href="/data-wrangling-blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Pivot_longer : Reshape Data in Pandas Efficiently and with Ease from Wide to Long</h1><p class="page-description">Reshaping Data Efficiently and with Ease</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-09-08T00:00:00-05:00" itemprop="datePublished">
        Sep 8, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Samuel Oranyeli</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      28 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/data-wrangling-blog/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/data-wrangling-blog/categories/#Pandas">Pandas</a>
        &nbsp;
      
        <a class="category-tags-link" href="/data-wrangling-blog/categories/#reshape">reshape</a>
        &nbsp;
      
        <a class="category-tags-link" href="/data-wrangling-blog/categories/#wide-to-long">wide-to-long</a>
        &nbsp;
      
        <a class="category-tags-link" href="/data-wrangling-blog/categories/#pivot_longer">pivot_longer</a>
        &nbsp;
      
        <a class="category-tags-link" href="/data-wrangling-blog/categories/#stack">stack</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/samukweku/data-wrangling-blog/tree/master/_notebooks/2022-09-08-Pivot_longer - Reshape Data in Pandas with Ease From Wide to Long.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/data-wrangling-blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Introduction">Introduction </a></li>
<li class="toc-entry toc-h2"><a href="#Basics">Basics </a></li>
<li class="toc-entry toc-h2"><a href="#Pattern-1---Melt-all-Columns">Pattern 1 - Melt all Columns </a></li>
<li class="toc-entry toc-h2"><a href="#Pattern-2A---Melt-into-multiple-columns---new-column-names">Pattern 2A - Melt into multiple columns - new column names </a></li>
<li class="toc-entry toc-h2"><a href="#Pattern-2B---Melt-into-multiple-columns---Use-variables-within-the-column-names-as-new-names">Pattern 2B - Melt into multiple columns - Use variables within the column names as new names </a></li>
<li class="toc-entry toc-h2"><a href="#Pattern-3A---Group-similar-columns-together">Pattern 3A - Group similar columns together </a></li>
<li class="toc-entry toc-h2"><a href="#Pattern-3B---Group-similar-columns-and-values-together">Pattern 3B - Group similar columns and values together </a></li>
<li class="toc-entry toc-h2"><a href="#Performance">Performance </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Summary">Summary </a></li>
</ul>
</li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-09-08-Pivot_longer - Reshape Data in Pandas with Ease From Wide to Long.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">
<a class="anchor" href="#Introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Introduction</strong><a class="anchor-link" href="#Introduction"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You've got data in a wide form (lots of columns), and you wish to transform it into a long form (fewer columns, more rows). In pandas, depending on the form of the data, this can be achieved with either <code>pd.stack</code>, <code>pd.melt</code>, <code>pd.wide_to_long</code>, and sometimes require a bit of data massaging before arriving at the final, desired form.</p>
<p>This article suggests a simple, efficient, opinionated way, that resolves most wide to long transformations, within a single function, using the <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> function from <a href="https://pyjanitor-devs.github.io/pyjanitor/">pyjanitor</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at an example, based on real data - this is a subset of the <a href="https://github.com/tidyverse/tidyr/blob/main/data-raw/who.csv">who</a> data from R:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">" pandas version :"</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> 
      <span class="s2">"numpy version :"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> 
      <span class="s2">"python version :"</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre> pandas version : 1.4.1 
 numpy version : 1.22.3 
 python version : 3.9.12 | packaged by conda-forge | (main, Mar 24 2022, 23:23:20) 
[Clang 12.0.1 ]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'id'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'new_sp_m5564'</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s1">'newrel_f65'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>new_sp_m5564</th>
      <th>newrel_f65</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at the dataframe above, we have multiple variables crammed into the column names. Using the definitions as described <a href="https://tidyr.tidyverse.org/articles/pivot.html#many-variables-in-column-names">here</a>:</p>

<pre><code>    - new_/new prefix indicates these are counts of new cases
    - sp/rel/ep describe how the case was diagnosed
    - m/f gives the gender
    - 5564/65 supplies the age range

</code></pre>
<p>Our goal here is to separate the dataframe into individual columns of  <code>count</code>, <code>diagnosis</code>,<code>gender</code>, <code>age</code>. How do we pull this off, with the current tools in Pandas?</p>
<p><code>pd.wide_to_long</code> is not applicable here, as there is no unique separator. Our best option would be to use a regular expression to pull out the individual columns.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With <code>pd.stack</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># split the columns using a regex, before stacking:</span>
<span class="n">DF</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span>
<span class="n">regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"new_?(.+)_(.)(\d+)"</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'diagnosis'</span><span class="p">,</span> <span class="s1">'gender'</span><span class="p">,</span> <span class="s1">'age'</span><span class="p">]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_frame</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">names</span> <span class="o">=</span> <span class="n">new_names</span><span class="p">)</span>
<span class="n">DF</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
<span class="n">DF</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">'count'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>diagnosis</th>
      <th>gender</th>
      <th>age</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>rel</td>
      <td>f</td>
      <td>65</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>sp</td>
      <td>m</td>
      <td>5564</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With <code>pd.melt</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DF</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span><span class="o">.</span><span class="n">set_axis</span><span class="p">(</span><span class="n">new_names</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">DF</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">'variable'</span><span class="p">),</span> <span class="n">out</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>value</th>
      <th>diagnosis</th>
      <th>gender</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>sp</td>
      <td>m</td>
      <td>5564</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>3</td>
      <td>rel</td>
      <td>f</td>
      <td>65</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note the extra steps we had to take to get to our final form. However, we know the pattern (a regex that matches the columns and the sub groups in the columns that we wish to extract), so why not take advantage of that? This is where <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> from <a href="https://pyjanitor-devs.github.io/pyjanitor/">pyjanitor</a> shines:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># pip install pyjanitor</span>
<span class="c1"># you can also install the dev version</span>
<span class="c1"># to access the latest developments</span>
<span class="c1"># pip install git+https://github.com/pyjanitor-devs/pyjanitor.git</span>
<span class="kn">import</span> <span class="nn">janitor</span>
<span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'id'</span><span class="p">,</span> 
    <span class="n">names_to</span> <span class="o">=</span> <span class="n">new_names</span><span class="p">,</span> 
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="n">regex</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>diagnosis</th>
      <th>gender</th>
      <th>age</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>sp</td>
      <td>m</td>
      <td>5564</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>rel</td>
      <td>f</td>
      <td>65</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Straight to the point. If there is a pattern, <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> will figure out what to do and deliver the results. It is a simple, efficient, reshaping abstraction.</p>
<p>Note that this post uses the dev version of <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Basics">
<a class="anchor" href="#Basics" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Basics</strong><a class="anchor-link" href="#Basics"> </a>
</h2>
<p>Let's walk through some of the parameters in <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a>:</p>

<pre><code>    - index : These are the columns that will not be transformed to long form - the values are repeated as necessary.
    - column_names: These are the columns that will be transformed to long form.
    - names_to : These will be the new column names of the reshaped DataFrame.
    - values_to: These will contain the values collated from the original DataFrame.
    - names_sep: extract individual columns with a separator.
    - names_pattern: extract individual columns with a regular expression, or a list of regular expressions.
    - names_transform: efficiently convert the columns aggregated from the `column_names` from string to another dtype, as long as it is supported by `pd.astype`

</code></pre>
<p>Keep in mind that <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> works on patterns - deciphering what pattern to use is the key to its simplicity.</p>
<p>The rest of the article outlines the various patterns that <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> works with.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pattern-1---Melt-all-Columns">
<a class="anchor" href="#Pattern-1---Melt-all-Columns" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Pattern 1 - Melt all Columns</strong><a class="anchor-link" href="#Pattern-1---Melt-all-Columns"> </a>
</h2>
<p>This is basic and is similar to what you get with <code>pd.melt</code>.</p>
<p>Let's use another realistic dataset - <a href="https://github.com/tidyverse/tidyr/blob/main/data-raw/relig_income.csv">relig_income</a> - the original example is from <a href="https://tidyr.tidyverse.org/articles/pivot.html#pew">here</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">"https://raw.githubusercontent.com/tidyverse/tidyr/main/data-raw/relig_income.csv"</span>
<span class="n">religion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">religion</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>&lt;$10k</th>
      <th>$10-20k</th>
      <th>$20-30k</th>
      <th>$30-40k</th>
      <th>$40-50k</th>
      <th>$50-75k</th>
      <th>$75-100k</th>
      <th>$100-150k</th>
      <th>&gt;150k</th>
      <th>Don't know/refused</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>27</td>
      <td>34</td>
      <td>60</td>
      <td>81</td>
      <td>76</td>
      <td>137</td>
      <td>122</td>
      <td>109</td>
      <td>84</td>
      <td>96</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>12</td>
      <td>27</td>
      <td>37</td>
      <td>52</td>
      <td>35</td>
      <td>70</td>
      <td>73</td>
      <td>59</td>
      <td>74</td>
      <td>76</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>27</td>
      <td>21</td>
      <td>30</td>
      <td>34</td>
      <td>33</td>
      <td>58</td>
      <td>62</td>
      <td>39</td>
      <td>53</td>
      <td>54</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>418</td>
      <td>617</td>
      <td>732</td>
      <td>670</td>
      <td>638</td>
      <td>1116</td>
      <td>949</td>
      <td>792</td>
      <td>633</td>
      <td>1489</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>15</td>
      <td>14</td>
      <td>15</td>
      <td>11</td>
      <td>10</td>
      <td>35</td>
      <td>21</td>
      <td>17</td>
      <td>18</td>
      <td>116</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">religion</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
          <span class="n">index</span> <span class="o">=</span> <span class="s1">'religion'</span><span class="p">,</span> 
          <span class="n">names_to</span> <span class="o">=</span> <span class="s1">'income'</span><span class="p">,</span> 
          <span class="n">values_to</span> <span class="o">=</span> <span class="s1">'count'</span>
          <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>income</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Agnostic</td>
      <td>&lt;$10k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Atheist</td>
      <td>&lt;$10k</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Buddhist</td>
      <td>&lt;$10k</td>
      <td>27</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Catholic</td>
      <td>&lt;$10k</td>
      <td>418</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Don’t know/refused</td>
      <td>&lt;$10k</td>
      <td>15</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>175</th>
      <td>Orthodox</td>
      <td>Don't know/refused</td>
      <td>73</td>
    </tr>
    <tr>
      <th>176</th>
      <td>Other Christian</td>
      <td>Don't know/refused</td>
      <td>18</td>
    </tr>
    <tr>
      <th>177</th>
      <td>Other Faiths</td>
      <td>Don't know/refused</td>
      <td>71</td>
    </tr>
    <tr>
      <th>178</th>
      <td>Other World Religions</td>
      <td>Don't know/refused</td>
      <td>8</td>
    </tr>
    <tr>
      <th>179</th>
      <td>Unaffiliated</td>
      <td>Don't know/refused</td>
      <td>597</td>
    </tr>
  </tbody>
</table>
<p>180 rows × 3 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If there are a lot of columns, we can dynamically select the <code>index</code>, or <code>column_names</code>, using the <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.select_columns.select_columns">janitor.select_columns</a> syntax. Let's apply it to another <a href="">dataset</a> related to billboard charts - original example is <a href="https://tidyr.tidyverse.org/articles/pivot.html#billboard">here</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">'https://raw.githubusercontent.com/tidyverse/tidyr/main/data-raw/billboard.csv'</span>
<span class="n">billboard</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">billboard</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>artist</th>
      <th>track</th>
      <th>time</th>
      <th>date.entered</th>
      <th>wk1</th>
      <th>wk2</th>
      <th>wk3</th>
      <th>wk4</th>
      <th>wk5</th>
      <th>...</th>
      <th>wk67</th>
      <th>wk68</th>
      <th>wk69</th>
      <th>wk70</th>
      <th>wk71</th>
      <th>wk72</th>
      <th>wk73</th>
      <th>wk74</th>
      <th>wk75</th>
      <th>wk76</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>4:22</td>
      <td>2000-02-26</td>
      <td>87</td>
      <td>82.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of ...</td>
      <td>3:15</td>
      <td>2000-09-02</td>
      <td>91</td>
      <td>87.0</td>
      <td>92.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Kryptonite</td>
      <td>3:53</td>
      <td>2000-04-08</td>
      <td>81</td>
      <td>70.0</td>
      <td>68.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Loser</td>
      <td>4:24</td>
      <td>2000-10-21</td>
      <td>76</td>
      <td>76.0</td>
      <td>72.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000</td>
      <td>504 Boyz</td>
      <td>Wobble Wobble</td>
      <td>3:35</td>
      <td>2000-04-15</td>
      <td>57</td>
      <td>34.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 81 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The columns that will be flipped to long form are the columns that start with <code>wk</code> - these will be passed to the <code>column_names</code> parameter. That is a lot of columns. Let's see how <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> simplifies this:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">billboard</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">column_names</span> <span class="o">=</span> <span class="s1">'wk*'</span><span class="p">,</span> <span class="n">names_to</span> <span class="o">=</span> <span class="s1">'week'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>artist</th>
      <th>track</th>
      <th>time</th>
      <th>date.entered</th>
      <th>week</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>4:22</td>
      <td>2000-02-26</td>
      <td>wk1</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of ...</td>
      <td>3:15</td>
      <td>2000-09-02</td>
      <td>wk1</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Kryptonite</td>
      <td>3:53</td>
      <td>2000-04-08</td>
      <td>wk1</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Loser</td>
      <td>4:24</td>
      <td>2000-10-21</td>
      <td>wk1</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000</td>
      <td>504 Boyz</td>
      <td>Wobble Wobble</td>
      <td>3:35</td>
      <td>2000-04-15</td>
      <td>wk1</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24087</th>
      <td>2000</td>
      <td>Yankee Grey</td>
      <td>Another Nine Minutes</td>
      <td>3:10</td>
      <td>2000-04-29</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24088</th>
      <td>2000</td>
      <td>Yearwood, Trisha</td>
      <td>Real Live Woman</td>
      <td>3:55</td>
      <td>2000-04-01</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24089</th>
      <td>2000</td>
      <td>Ying Yang Twins</td>
      <td>Whistle While You Tw...</td>
      <td>4:19</td>
      <td>2000-03-18</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24090</th>
      <td>2000</td>
      <td>Zombie Nation</td>
      <td>Kernkraft 400</td>
      <td>3:30</td>
      <td>2000-09-02</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24091</th>
      <td>2000</td>
      <td>matchbox twenty</td>
      <td>Bent</td>
      <td>4:12</td>
      <td>2000-04-29</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>24092 rows × 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want to use the <code>index</code> parameter instead, that's easy as well:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">billboard</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'date.entered'</span><span class="p">),</span> <span class="n">names_to</span> <span class="o">=</span> <span class="s1">'week'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>artist</th>
      <th>track</th>
      <th>time</th>
      <th>date.entered</th>
      <th>week</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>4:22</td>
      <td>2000-02-26</td>
      <td>wk1</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of ...</td>
      <td>3:15</td>
      <td>2000-09-02</td>
      <td>wk1</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Kryptonite</td>
      <td>3:53</td>
      <td>2000-04-08</td>
      <td>wk1</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Loser</td>
      <td>4:24</td>
      <td>2000-10-21</td>
      <td>wk1</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2000</td>
      <td>504 Boyz</td>
      <td>Wobble Wobble</td>
      <td>3:35</td>
      <td>2000-04-15</td>
      <td>wk1</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>24087</th>
      <td>2000</td>
      <td>Yankee Grey</td>
      <td>Another Nine Minutes</td>
      <td>3:10</td>
      <td>2000-04-29</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24088</th>
      <td>2000</td>
      <td>Yearwood, Trisha</td>
      <td>Real Live Woman</td>
      <td>3:55</td>
      <td>2000-04-01</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24089</th>
      <td>2000</td>
      <td>Ying Yang Twins</td>
      <td>Whistle While You Tw...</td>
      <td>4:19</td>
      <td>2000-03-18</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24090</th>
      <td>2000</td>
      <td>Zombie Nation</td>
      <td>Kernkraft 400</td>
      <td>3:30</td>
      <td>2000-09-02</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24091</th>
      <td>2000</td>
      <td>matchbox twenty</td>
      <td>Bent</td>
      <td>4:12</td>
      <td>2000-04-29</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>24092 rows × 7 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pattern-2A---Melt-into-multiple-columns---new-column-names">
<a class="anchor" href="#Pattern-2A---Melt-into-multiple-columns---new-column-names" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Pattern 2A - Melt into multiple columns - new column names</strong><a class="anchor-link" href="#Pattern-2A---Melt-into-multiple-columns---new-column-names"> </a>
</h2>
<p>There are scenarios where multiple variables are crammed into the column names - we had a look at that already with the <code>who</code> <a href="##-Introduction-">example</a>.</p>
<p>Let's look at an example, adapted from <a href="https://rdatatable.gitlab.io/data.table/articles/datatable-reshape.html#a-enhanced-melt">data.table vignette</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">'Sepal.Length'</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">],</span>
     <span class="s1">'Sepal.Width'</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span>
     <span class="s1">'Petal.Length'</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">5.1</span><span class="p">],</span>
     <span class="s1">'Petal.Width'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">],</span>
     <span class="s1">'Species'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'setosa'</span><span class="p">,</span> <span class="s1">'virginica'</span><span class="p">]}</span>
    <span class="p">)</span>

<span class="n">iris</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sepal.Length</th>
      <th>Sepal.Width</th>
      <th>Petal.Length</th>
      <th>Petal.Width</th>
      <th>Species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.9</td>
      <td>3.0</td>
      <td>5.1</td>
      <td>1.8</td>
      <td>virginica</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the data above, we wish to consolidate the columns into <code>part</code> and <code>dimensions</code> - the <code>Sepal/Petal</code> prefixes go into the <code>part</code> column, while <code>Width/Length</code> go into the <code>dimension</code> column.</p>
<p>In this case, we can use either the <code>names_sep</code> or the <code>names_pattern</code> parameter - for this particular scenario, the <code>names_sep</code> option is a better fit:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
        <span class="n">index</span> <span class="o">=</span> <span class="s1">'Species'</span><span class="p">,</span>
        <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'part'</span><span class="p">,</span> <span class="s1">'dimension'</span><span class="p">],</span>
        <span class="n">names_sep</span> <span class="o">=</span> <span class="s1">'.'</span>
        <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>part</th>
      <th>dimension</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>setosa</td>
      <td>Sepal</td>
      <td>Length</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>virginica</td>
      <td>Sepal</td>
      <td>Length</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>setosa</td>
      <td>Sepal</td>
      <td>Width</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>virginica</td>
      <td>Sepal</td>
      <td>Width</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>setosa</td>
      <td>Petal</td>
      <td>Length</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>virginica</td>
      <td>Petal</td>
      <td>Length</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>setosa</td>
      <td>Petal</td>
      <td>Width</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>virginica</td>
      <td>Petal</td>
      <td>Width</td>
      <td>1.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using names_pattern:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
        <span class="n">index</span> <span class="o">=</span> <span class="s1">'Species'</span><span class="p">,</span>
        <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'part'</span><span class="p">,</span> <span class="s1">'dimension'</span><span class="p">],</span>
        <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'(.+)\.(.+)'</span>
        <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>part</th>
      <th>dimension</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>setosa</td>
      <td>Sepal</td>
      <td>Length</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>virginica</td>
      <td>Sepal</td>
      <td>Length</td>
      <td>5.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>setosa</td>
      <td>Sepal</td>
      <td>Width</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>virginica</td>
      <td>Sepal</td>
      <td>Width</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>setosa</td>
      <td>Petal</td>
      <td>Length</td>
      <td>1.4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>virginica</td>
      <td>Petal</td>
      <td>Length</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>setosa</td>
      <td>Petal</td>
      <td>Width</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>virginica</td>
      <td>Petal</td>
      <td>Width</td>
      <td>1.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pattern-2B---Melt-into-multiple-columns---Use-variables-within-the-column-names-as-new-names">
<a class="anchor" href="#Pattern-2B---Melt-into-multiple-columns---Use-variables-within-the-column-names-as-new-names" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Pattern 2B - Melt into multiple columns - Use variables within the column names as new names</strong><a class="anchor-link" href="#Pattern-2B---Melt-into-multiple-columns---Use-variables-within-the-column-names-as-new-names"> </a>
</h2>
<p>Instead of new column names, what if we wanted to use existing variables within the column names?</p>
<p>Let's look at an example adapted from <a href="https://rdatatable.gitlab.io/data.table/articles/datatable-reshape.html#a-melting-data-tables-wide-to-long">data.table vignette</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">"family"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
            <span class="s2">"dob_child1"</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">"1998-11-26"</span><span class="p">,</span>
                <span class="s2">"1996-06-22"</span><span class="p">,</span>
                <span class="s2">"2002-07-11"</span><span class="p">,</span>
                <span class="s2">"2004-10-10"</span><span class="p">,</span>
                <span class="s2">"2000-12-05"</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">"dob_child2"</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">"2000-01-29"</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                <span class="s2">"2004-04-05"</span><span class="p">,</span>
                <span class="s2">"2009-08-27"</span><span class="p">,</span>
                <span class="s2">"2005-02-28"</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">"gender_child1"</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="s2">"gender_child2"</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>

<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>family</th>
      <th>dob_child1</th>
      <th>dob_child2</th>
      <th>gender_child1</th>
      <th>gender_child2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1998-11-26</td>
      <td>2000-01-29</td>
      <td>1</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1996-06-22</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2002-07-11</td>
      <td>2004-04-05</td>
      <td>2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>2004-10-10</td>
      <td>2009-08-27</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>2000-12-05</td>
      <td>2005-02-28</td>
      <td>2</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the data above, we wish to keep <code>dob</code> and <code>gender</code> as column names, while moving <code>child1</code> and <code>child2</code> to a new column. How does <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> reshape this?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'family'</span><span class="p">,</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'.value'</span><span class="p">,</span> <span class="s1">'child'</span><span class="p">),</span>
    <span class="n">names_sep</span> <span class="o">=</span> <span class="s1">'_'</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>family</th>
      <th>child</th>
      <th>dob</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>child1</td>
      <td>1998-11-26</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>child1</td>
      <td>1996-06-22</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>child1</td>
      <td>2002-07-11</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>child1</td>
      <td>2004-10-10</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>child1</td>
      <td>2000-12-05</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>child2</td>
      <td>2000-01-29</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>child2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>child2</td>
      <td>2004-04-05</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>child2</td>
      <td>2009-08-27</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5</td>
      <td>child2</td>
      <td>2005-02-28</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For patterns such as this, where a part of the column name is to be retained as header in the new dataframe, the <code>.value</code> placeholder comes in handy. The <code>.value</code> placeholder tells <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> - <code>hey, this variable in the column name is to be retained as a header</code>. <a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> gets the message and acts accordingly.</p>
<p>Take column label <code>dob_child1</code> - the first part is <code>dob</code> and the second part is <code>child1</code>. This pairs with <code>(.value, child)</code>, meaning <code>dob</code> stays as header, and the rest gets lumped into the <code>child</code> column. The <code>names_sep</code> value - <code>_</code> - determines how the column is split into the new columns.</p>
<p>With <code>names_pattern</code> we can have more control on the output, selecting just the numbers in the <code>child</code> column:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'family'</span><span class="p">,</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'.value'</span><span class="p">,</span> <span class="s1">'child'</span><span class="p">),</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(.+)_child(\d)"</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>family</th>
      <th>child</th>
      <th>dob</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1998-11-26</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1996-06-22</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>2002-07-11</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>2004-10-10</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
      <td>2000-12-05</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>2</td>
      <td>2000-01-29</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>2</td>
      <td>2004-04-05</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>2</td>
      <td>2009-08-27</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5</td>
      <td>2</td>
      <td>2005-02-28</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also efficiently convert the data type of <code>child</code> to integer, using the <code>names_transform</code> option:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'family'</span><span class="p">,</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'.value'</span><span class="p">,</span> <span class="s1">'child'</span><span class="p">),</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(.+)_child(\d)"</span><span class="p">,</span>
    <span class="n">names_transform</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>family</th>
      <th>child</th>
      <th>dob</th>
      <th>gender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1998-11-26</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1996-06-22</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>2002-07-11</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>2004-10-10</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
      <td>2000-12-05</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>2</td>
      <td>2000-01-29</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>2</td>
      <td>2004-04-05</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>2</td>
      <td>2009-08-27</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5</td>
      <td>2</td>
      <td>2005-02-28</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The flexibility of <code>.value</code> means you can place it anywhere - you are not limited by position - as long as the right argument is passed to the <code>names_sep</code> or <code>names_pattern</code> parameter, your output should be fine.</p>
<p>Let's apply this to the <code>iris</code> <a href="##-Pattern-2A---Melt-into-multiple-columns---new-column-names-">dataset</a> to test the flexibility of <code>.value</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'Species'</span><span class="p">,</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'part'</span><span class="p">,</span> <span class="s1">'.value'</span><span class="p">),</span>
    <span class="n">names_sep</span> <span class="o">=</span> <span class="s1">'.'</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Species</th>
      <th>part</th>
      <th>Length</th>
      <th>Width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>setosa</td>
      <td>Sepal</td>
      <td>5.1</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>virginica</td>
      <td>Sepal</td>
      <td>5.9</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>setosa</td>
      <td>Petal</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>virginica</td>
      <td>Petal</td>
      <td>5.1</td>
      <td>1.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use multiple <code>.value</code> if required - let's apply this to a question from <a href="https://stackoverflow.com/questions/12466493/reshaping-multiple-sets-of-measurement-columns-wide-format-into-single-columns">Stack Overflow</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">"ID"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">"DateRange1Start"</span><span class="p">:</span> <span class="s2">"1/1/90"</span><span class="p">,</span>
                    <span class="s2">"DateRange1End"</span><span class="p">:</span> <span class="s2">"3/1/90"</span><span class="p">,</span>
                    <span class="s2">"Value1"</span><span class="p">:</span> <span class="mf">4.4</span><span class="p">,</span>
                    <span class="s2">"DateRange2Start"</span><span class="p">:</span> <span class="s2">"4/5/91"</span><span class="p">,</span>
                    <span class="s2">"DateRange2End"</span><span class="p">:</span> <span class="s2">"6/7/91"</span><span class="p">,</span>
                    <span class="s2">"Value2"</span><span class="p">:</span> <span class="mf">6.2</span><span class="p">,</span>
                    <span class="s2">"DateRange3Start"</span><span class="p">:</span> <span class="s2">"5/5/95"</span><span class="p">,</span>
                    <span class="s2">"DateRange3End"</span><span class="p">:</span> <span class="s2">"6/6/96"</span><span class="p">,</span>
                    <span class="s2">"Value3"</span><span class="p">:</span> <span class="mf">3.3</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">])</span>

<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>DateRange1Start</th>
      <th>DateRange1End</th>
      <th>Value1</th>
      <th>DateRange2Start</th>
      <th>DateRange2End</th>
      <th>Value2</th>
      <th>DateRange3Start</th>
      <th>DateRange3End</th>
      <th>Value3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'ID'</span><span class="p">,</span> 
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'.value'</span><span class="p">,</span> <span class="s1">'.value'</span><span class="p">),</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(.+)\d(.*)"</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>DateRangeStart</th>
      <th>DateRangeEnd</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1/1/90</td>
      <td>3/1/90</td>
      <td>4.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>4/5/91</td>
      <td>6/7/91</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>5/5/95</td>
      <td>6/6/96</td>
      <td>3.3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, as long as the pattern can be identified, <code>pivot_longer</code> will take care of the rest.</p>
<p>One more example, adapted from <a href="https://stackoverflow.com/questions/64107566/how-to-pivot-longer-and-populate-with-fields-from-column-names-at-the-same-tim?noredirect=1#comment113369419_64107566">Stack Overflow</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">"Sony | TV | Model | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"A222"</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">"A234"</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">"A4345"</span><span class="p">},</span>
        <span class="s2">"Sony | TV | Quantity | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
        <span class="s2">"Sony | TV | Max-quant | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
        <span class="s2">"Panasonic | TV | Model | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"T232"</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">"S3424"</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">"X3421"</span><span class="p">},</span>
        <span class="s2">"Panasonic | TV | Quantity | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
        <span class="s2">"Panasonic | TV | Max-quant | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">11</span><span class="p">},</span>
        <span class="s2">"Sanyo | Radio | Model | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">"S111"</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">"S1s1"</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">"S1s2"</span><span class="p">},</span>
        <span class="s2">"Sanyo | Radio | Quantity | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
        <span class="s2">"Sanyo | Radio | Max-quant | value"</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sony | TV | Model | value</th>
      <th>Sony | TV | Quantity | value</th>
      <th>Sony | TV | Max-quant | value</th>
      <th>Panasonic | TV | Model | value</th>
      <th>Panasonic | TV | Quantity | value</th>
      <th>Panasonic | TV | Max-quant | value</th>
      <th>Sanyo | Radio | Model | value</th>
      <th>Sanyo | Radio | Quantity | value</th>
      <th>Sanyo | Radio | Max-quant | value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A222</td>
      <td>5</td>
      <td>10</td>
      <td>T232</td>
      <td>1</td>
      <td>10</td>
      <td>S111</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A234</td>
      <td>5</td>
      <td>9</td>
      <td>S3424</td>
      <td>5</td>
      <td>12</td>
      <td>S1s1</td>
      <td>2</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A4345</td>
      <td>4</td>
      <td>9</td>
      <td>X3421</td>
      <td>1</td>
      <td>11</td>
      <td>S1s2</td>
      <td>4</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"Manufacturer"</span><span class="p">,</span> <span class="s2">"Device"</span><span class="p">,</span> <span class="s2">".value"</span><span class="p">),</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(.+)\|(.+)\|(.+)\|.*"</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Manufacturer</th>
      <th>Device</th>
      <th>Model</th>
      <th>Quantity</th>
      <th>Max-quant</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A222</td>
      <td>5</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A234</td>
      <td>5</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sony</td>
      <td>TV</td>
      <td>A4345</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>T232</td>
      <td>1</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>S3424</td>
      <td>5</td>
      <td>12</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Panasonic</td>
      <td>TV</td>
      <td>X3421</td>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S111</td>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S1s1</td>
      <td>2</td>
      <td>9</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Sanyo</td>
      <td>Radio</td>
      <td>S1s2</td>
      <td>4</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pattern-3A---Group-similar-columns-together">
<a class="anchor" href="#Pattern-3A---Group-similar-columns-together" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Pattern 3A - Group similar columns together</strong><a class="anchor-link" href="#Pattern-3A---Group-similar-columns-together"> </a>
</h2>
<p>This is best explained with an example:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_mean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'x_1_mean'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">],</span>
                   <span class="s1">'x_2_mean'</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">],</span>
                   <span class="s1">'y_1_mean'</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">],</span>
                   <span class="s1">'y_2_mean'</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">],</span>
                   <span class="s1">'unit'</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">]})</span>

<span class="n">df_mean</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x_1_mean</th>
      <th>x_2_mean</th>
      <th>y_1_mean</th>
      <th>y_2_mean</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>20</td>
      <td>30</td>
      <td>40</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the dataframe above, we wish to lump similar columns together - specifically, we want to lump the <code>x*</code> columns into one, same goes for the <code>y*</code> columns.</p>
<p>For this pattern, we pass a list of names to <code>names_to</code>, while passing a list of regular expressions to <code>names_pattern</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_mean</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'unit'</span><span class="p">,</span> 
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'x_mean'</span><span class="p">,</span> <span class="s1">'y_mean'</span><span class="p">],</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unit</th>
      <th>x_mean</th>
      <th>y_mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>10</td>
      <td>30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>20</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using a list of regular expressions for <code>names_pattern</code> implies that you want to group similar items under specified columns in <code>names_to</code>.</p>
<p>Basically, it is a pairing. the first <code>x_1_mean</code> pairs with the first <code>y*</code> mean which it encounters, which is <code>y_1_mean</code>, same goes for the next <code>x*</code>, which is <code>x_2_mean</code>, it pairs with <code>y_2_mean</code>, since that is the next available <code>y*</code>. The pairing is on a first come first serve basis.</p>
<p>Let's look at another <a href="https://github.com/PacktPublishing/Pandas-Cookbook/blob/master/data/movie_altered.csv">example</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s2">"https://raw.githubusercontent.com/PacktPublishing/Pandas-Cookbook/master/data/movie_altered.csv"</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>rating</th>
      <th>year</th>
      <th>duration</th>
      <th>director_1</th>
      <th>director_fb_likes_1</th>
      <th>actor_1</th>
      <th>actor_2</th>
      <th>actor_3</th>
      <th>actor_fb_likes_1</th>
      <th>actor_fb_likes_2</th>
      <th>actor_fb_likes_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>PG-13</td>
      <td>2009.0</td>
      <td>178.0</td>
      <td>James Cameron</td>
      <td>0.0</td>
      <td>CCH Pounder</td>
      <td>Joel David Moore</td>
      <td>Wes Studi</td>
      <td>1000.0</td>
      <td>936.0</td>
      <td>855.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>PG-13</td>
      <td>2007.0</td>
      <td>169.0</td>
      <td>Gore Verbinski</td>
      <td>563.0</td>
      <td>Johnny Depp</td>
      <td>Orlando Bloom</td>
      <td>Jack Davenport</td>
      <td>40000.0</td>
      <td>5000.0</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spectre</td>
      <td>PG-13</td>
      <td>2015.0</td>
      <td>148.0</td>
      <td>Sam Mendes</td>
      <td>0.0</td>
      <td>Christoph Waltz</td>
      <td>Rory Kinnear</td>
      <td>Stephanie Sigman</td>
      <td>11000.0</td>
      <td>393.0</td>
      <td>161.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight Rises</td>
      <td>PG-13</td>
      <td>2012.0</td>
      <td>164.0</td>
      <td>Christopher Nolan</td>
      <td>22000.0</td>
      <td>Tom Hardy</td>
      <td>Christian Bale</td>
      <td>Joseph Gordon-Levitt</td>
      <td>27000.0</td>
      <td>23000.0</td>
      <td>23000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars: Episode VII - The Force Awakens</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>131.0</td>
      <td>Doug Walker</td>
      <td>Rob Walker</td>
      <td>NaN</td>
      <td>131.0</td>
      <td>12.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal for the dataframe above is to group the actors into another column, and the facebook likes into a separate column. The pattern here is obvious - we are grouping similar columns, so we pass a list of regular expressions to <code>names_pattern</code>, with an equal number of names to <code>names_to</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">movies</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">),</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'director'</span><span class="p">,</span> <span class="s1">'director_fb_likes'</span><span class="p">,</span> <span class="s1">'actor'</span><span class="p">,</span> <span class="s1">'actor_fb_likes'</span><span class="p">],</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'director_\d$'</span><span class="p">,</span> <span class="s1">'director_fb_likes'</span><span class="p">,</span> <span class="s1">'actor_\d$'</span><span class="p">,</span> <span class="s1">'actor.+'</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>rating</th>
      <th>year</th>
      <th>duration</th>
      <th>director</th>
      <th>director_fb_likes</th>
      <th>actor</th>
      <th>actor_fb_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>PG-13</td>
      <td>2009.0</td>
      <td>178.0</td>
      <td>James Cameron</td>
      <td>0.0</td>
      <td>CCH Pounder</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>PG-13</td>
      <td>2007.0</td>
      <td>169.0</td>
      <td>Gore Verbinski</td>
      <td>563.0</td>
      <td>Johnny Depp</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spectre</td>
      <td>PG-13</td>
      <td>2015.0</td>
      <td>148.0</td>
      <td>Sam Mendes</td>
      <td>0.0</td>
      <td>Christoph Waltz</td>
      <td>11000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight Rises</td>
      <td>PG-13</td>
      <td>2012.0</td>
      <td>164.0</td>
      <td>Christopher Nolan</td>
      <td>22000.0</td>
      <td>Tom Hardy</td>
      <td>27000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars: Episode VII - The Force Awakens</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>131.0</td>
      <td>Doug Walker</td>
      <td>131.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14743</th>
      <td>Signed Sealed Delivered</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>87.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Crystal Lowe</td>
      <td>319.0</td>
    </tr>
    <tr>
      <th>14744</th>
      <td>The Following</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sam Underwood</td>
      <td>319.0</td>
    </tr>
    <tr>
      <th>14745</th>
      <td>A Plague So Pleasant</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>76.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>David Chandler</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14746</th>
      <td>Shanghai Calling</td>
      <td>PG-13</td>
      <td>2012.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Eliza Coupe</td>
      <td>490.0</td>
    </tr>
    <tr>
      <th>14747</th>
      <td>My Date with Drew</td>
      <td>PG</td>
      <td>2004.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jon Gunn</td>
      <td>16.0</td>
    </tr>
  </tbody>
</table>
<p>14748 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on the same first come first serve approach, <code>director_1</code> is paired with <code>director_fb_likes_1</code>, <code>actor_1</code> is paired with <code>actor_fb_likes_1</code>; the pairing continues for the rest.</p>
<p>This could also have been solved using the <code>.value</code> approach:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">movies</span>
<span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">),</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="s2">".value"</span><span class="p">,</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(.+)_\d"</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>rating</th>
      <th>year</th>
      <th>duration</th>
      <th>director</th>
      <th>director_fb_likes</th>
      <th>actor</th>
      <th>actor_fb_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>PG-13</td>
      <td>2009.0</td>
      <td>178.0</td>
      <td>James Cameron</td>
      <td>0.0</td>
      <td>CCH Pounder</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>PG-13</td>
      <td>2007.0</td>
      <td>169.0</td>
      <td>Gore Verbinski</td>
      <td>563.0</td>
      <td>Johnny Depp</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Spectre</td>
      <td>PG-13</td>
      <td>2015.0</td>
      <td>148.0</td>
      <td>Sam Mendes</td>
      <td>0.0</td>
      <td>Christoph Waltz</td>
      <td>11000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight Rises</td>
      <td>PG-13</td>
      <td>2012.0</td>
      <td>164.0</td>
      <td>Christopher Nolan</td>
      <td>22000.0</td>
      <td>Tom Hardy</td>
      <td>27000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars: Episode VII - The Force Awakens</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Doug Walker</td>
      <td>131.0</td>
      <td>Doug Walker</td>
      <td>131.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14743</th>
      <td>Signed Sealed Delivered</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>87.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Crystal Lowe</td>
      <td>319.0</td>
    </tr>
    <tr>
      <th>14744</th>
      <td>The Following</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Sam Underwood</td>
      <td>319.0</td>
    </tr>
    <tr>
      <th>14745</th>
      <td>A Plague So Pleasant</td>
      <td>NaN</td>
      <td>2013.0</td>
      <td>76.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>David Chandler</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14746</th>
      <td>Shanghai Calling</td>
      <td>PG-13</td>
      <td>2012.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Eliza Coupe</td>
      <td>490.0</td>
    </tr>
    <tr>
      <th>14747</th>
      <td>My Date with Drew</td>
      <td>PG</td>
      <td>2004.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jon Gunn</td>
      <td>16.0</td>
    </tr>
  </tbody>
</table>
<p>14748 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, it is all about identifying the pattern, and using whichever option is more suitable/convenient. One more <a href="https://github.com/tidyverse/tidyr/issues/1378#issue-1300743144">example</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">NA</span>
<span class="n">treatments</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
  <span class="nb">id</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
  <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"A"</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="s2">"A"</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">),</span>
  <span class="n">A_date</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">),</span>
  <span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="n">NA</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="s2">"B"</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">),</span>
  <span class="n">B_date</span> <span class="o">=</span> <span class="p">(</span><span class="n">NA</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">),</span>
  <span class="n">other</span> <span class="o">=</span> <span class="p">(</span><span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="s2">"C"</span><span class="p">,</span> <span class="s2">"D"</span><span class="p">),</span>
  <span class="n">other_date</span> <span class="o">=</span> <span class="p">(</span><span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="n">NA</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">treatments</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">treatments</span><span class="p">)</span>
<span class="n">treatments</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>A</th>
      <th>A_date</th>
      <th>B</th>
      <th>B_date</th>
      <th>other</th>
      <th>other_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>B</td>
      <td>3</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>A</td>
      <td>2</td>
      <td>B</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>D</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal is to transform the dataframe into three columns, an <code>id</code> column, a <code>treatment</code> column, and a <code>date</code> column. Since we are grouping similar columns, we pass a list of regular expressions to <code>names_pattern</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">treatments</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'id'</span><span class="p">,</span> 
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'treatment'</span><span class="p">,</span> <span class="s1">'date'</span><span class="p">],</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'A$|B$|other$'</span><span class="p">,</span> <span class="s1">'.+date$'</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>treatment</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>A</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>B</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>B</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4</td>
      <td>C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>5</td>
      <td>D</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another way is to access the dates before the treatments, by reversing the order of the regular expressions:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">treatments</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="s1">'id'</span><span class="p">,</span> 
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'date'</span><span class="p">,</span> <span class="s1">'treatment'</span><span class="p">],</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'.+date$'</span><span class="p">,</span> <span class="s1">'.+'</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>treatment</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>A</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>B</td>
      <td>3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3</td>
      <td>B</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>12</th>
      <td>3</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>13</th>
      <td>4</td>
      <td>C</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>5</td>
      <td>D</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pattern-3B---Group-similar-columns-and-values-together">
<a class="anchor" href="#Pattern-3B---Group-similar-columns-and-values-together" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Pattern 3B - Group similar columns and values together</strong><a class="anchor-link" href="#Pattern-3B---Group-similar-columns-and-values-together"> </a>
</h2>
<p>This is best illustrated with an <a href="https://stackoverflow.com/q/51519101/7175713">example</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'City'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Houston'</span><span class="p">,</span> <span class="s1">'Austin'</span><span class="p">,</span> <span class="s1">'Hoover'</span><span class="p">],</span>
                   <span class="s1">'State'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'Texas'</span><span class="p">,</span> <span class="s1">'Texas'</span><span class="p">,</span> <span class="s1">'Alabama'</span><span class="p">],</span>
                   <span class="s1">'Name'</span><span class="p">:[</span><span class="s1">'Aria'</span><span class="p">,</span> <span class="s1">'Penelope'</span><span class="p">,</span> <span class="s1">'Niko'</span><span class="p">],</span>
                   <span class="s1">'Mango'</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span>
                   <span class="s1">'Orange'</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span> 
                   <span class="s1">'Watermelon'</span><span class="p">:[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span>
                   <span class="s1">'Gin'</span><span class="p">:[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">34</span><span class="p">],</span>
                   <span class="s1">'Vodka'</span><span class="p">:[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">18</span><span class="p">]},</span>
                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'City'</span><span class="p">,</span> <span class="s1">'State'</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Mango'</span><span class="p">,</span> <span class="s1">'Orange'</span><span class="p">,</span> <span class="s1">'Watermelon'</span><span class="p">,</span> <span class="s1">'Gin'</span><span class="p">,</span> <span class="s1">'Vodka'</span><span class="p">])</span>


<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>City</th>
      <th>State</th>
      <th>Name</th>
      <th>Mango</th>
      <th>Orange</th>
      <th>Watermelon</th>
      <th>Gin</th>
      <th>Vodka</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Houston</td>
      <td>Texas</td>
      <td>Aria</td>
      <td>4</td>
      <td>10</td>
      <td>40</td>
      <td>16</td>
      <td>20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Austin</td>
      <td>Texas</td>
      <td>Penelope</td>
      <td>10</td>
      <td>8</td>
      <td>99</td>
      <td>200</td>
      <td>33</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hoover</td>
      <td>Alabama</td>
      <td>Niko</td>
      <td>90</td>
      <td>14</td>
      <td>43</td>
      <td>34</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal in this case is to group similar columns <strong>and</strong> values together - group the drinks into one column, group the fruits into another column. When that is done, group the values for the drinks into one column, and the values for the fruits into another column. That's the pattern, and for this pattern we continue with the idea from <a href="##-Pattern-3A---Group-similar-columns-together-">earlier</a>, by passing a list of regular expressions to <code>names_pattern</code>, an equal number of names to <code>names_to</code>, <strong>and</strong> an equal number of names to <code>values_to</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">"City"</span><span class="p">,</span> <span class="s2">"State"</span><span class="p">],</span>
    <span class="n">column_names</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s2">"Mango"</span><span class="p">,</span> <span class="s2">"Vodka"</span><span class="p">),</span>
    <span class="n">names_to</span><span class="o">=</span><span class="p">(</span><span class="s2">"Fruit"</span><span class="p">,</span> <span class="s2">"Drink"</span><span class="p">),</span>
    <span class="n">values_to</span><span class="o">=</span><span class="p">(</span><span class="s2">"Pounds"</span><span class="p">,</span> <span class="s2">"Ounces"</span><span class="p">),</span>
    <span class="n">names_pattern</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s2">"M|O|W"</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"G|V"</span><span class="p">],</span>
   <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>City</th>
      <th>State</th>
      <th>Fruit</th>
      <th>Pounds</th>
      <th>Drink</th>
      <th>Ounces</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Houston</td>
      <td>Texas</td>
      <td>Mango</td>
      <td>4</td>
      <td>Gin</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Austin</td>
      <td>Texas</td>
      <td>Mango</td>
      <td>10</td>
      <td>Gin</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hoover</td>
      <td>Alabama</td>
      <td>Mango</td>
      <td>90</td>
      <td>Gin</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Houston</td>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
      <td>Vodka</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Austin</td>
      <td>Texas</td>
      <td>Orange</td>
      <td>8</td>
      <td>Vodka</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Hoover</td>
      <td>Alabama</td>
      <td>Orange</td>
      <td>14</td>
      <td>Vodka</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Houston</td>
      <td>Texas</td>
      <td>Watermelon</td>
      <td>40</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Austin</td>
      <td>Texas</td>
      <td>Watermelon</td>
      <td>99</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Hoover</td>
      <td>Alabama</td>
      <td>Watermelon</td>
      <td>43</td>
      <td>None</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Simple, straightforward, to the point, and efficient. Let's look at another <a href="https://stackoverflow.com/q/37422487/7175713">example</a>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'State'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'CA'</span><span class="p">,</span> <span class="s1">'CA'</span><span class="p">,</span> <span class="s1">'FL'</span><span class="p">,</span> <span class="s1">'FL'</span><span class="p">],</span>
 <span class="s1">'ItemN'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
 <span class="s1">'x1'</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
 <span class="s1">'x2'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
 <span class="s1">'x3'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
 <span class="s1">'y1'</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
 <span class="s1">'y2'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
 <span class="s1">'y3'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
 <span class="s1">'z1'</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
 <span class="s1">'z2'</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
 <span class="s1">'z3'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>ItemN</th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>y1</th>
      <th>y2</th>
      <th>y3</th>
      <th>z1</th>
      <th>z2</th>
      <th>z3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>1</td>
      <td>6</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
      <td>5</td>
      <td>3</td>
      <td>11</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CA</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>1</td>
      <td>15</td>
      <td>10</td>
      <td>5</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>13</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FL</td>
      <td>4</td>
      <td>9</td>
      <td>4</td>
      <td>2</td>
      <td>16</td>
      <td>14</td>
      <td>12</td>
      <td>14</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal is to group all the <code>x</code> columns into one, the <code>y</code> columns into one column, and group the associated values into individual columns as well. We are grouping similar columns <strong>and</strong> values - that's the pattern - again we pass a list of regular expressions to <code>names_pattern</code>, a list of names to <code>names_to</code>, and a list of names to <code>values_to</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'State'</span><span class="p">,</span> <span class="s1">'ItemN'</span><span class="p">],</span> 
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">],</span> 
    <span class="n">values_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'xvalue'</span><span class="p">,</span> <span class="s1">'yvalue'</span><span class="p">,</span> <span class="s1">'zvalue'</span><span class="p">],</span> 
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="s1">'z'</span><span class="p">],</span> 
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>ItemN</th>
      <th>x</th>
      <th>xvalue</th>
      <th>y</th>
      <th>yvalue</th>
      <th>z</th>
      <th>zvalue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CA</td>
      <td>1</td>
      <td>x1</td>
      <td>6</td>
      <td>y1</td>
      <td>7</td>
      <td>z1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CA</td>
      <td>2</td>
      <td>x1</td>
      <td>7</td>
      <td>y1</td>
      <td>15</td>
      <td>z1</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FL</td>
      <td>3</td>
      <td>x1</td>
      <td>3</td>
      <td>y1</td>
      <td>5</td>
      <td>z1</td>
      <td>13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FL</td>
      <td>4</td>
      <td>x1</td>
      <td>9</td>
      <td>y1</td>
      <td>16</td>
      <td>z1</td>
      <td>14</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CA</td>
      <td>1</td>
      <td>x2</td>
      <td>4</td>
      <td>y2</td>
      <td>5</td>
      <td>z2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CA</td>
      <td>2</td>
      <td>x2</td>
      <td>3</td>
      <td>y2</td>
      <td>10</td>
      <td>z2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>FL</td>
      <td>3</td>
      <td>x2</td>
      <td>2</td>
      <td>y2</td>
      <td>3</td>
      <td>z2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>FL</td>
      <td>4</td>
      <td>x2</td>
      <td>4</td>
      <td>y2</td>
      <td>14</td>
      <td>z2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>CA</td>
      <td>1</td>
      <td>x3</td>
      <td>3</td>
      <td>y3</td>
      <td>3</td>
      <td>z3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>CA</td>
      <td>2</td>
      <td>x3</td>
      <td>1</td>
      <td>y3</td>
      <td>5</td>
      <td>z3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>FL</td>
      <td>3</td>
      <td>x3</td>
      <td>1</td>
      <td>y3</td>
      <td>2</td>
      <td>z3</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>FL</td>
      <td>4</td>
      <td>x3</td>
      <td>2</td>
      <td>y3</td>
      <td>12</td>
      <td>z3</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Performance">
<a class="anchor" href="#Performance" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Performance</strong><a class="anchor-link" href="#Performance"> </a>
</h2>
<p><a href="https://pyjanitor-devs.github.io/pyjanitor/api/functions/#janitor.functions.pivot.pivot_longer">pivot_longer</a> is not just simple, convenient, and straightforward, it is efficient as well:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> religion.pivot_longer(index = 'religion', names_to = 'income', values_to = 'count')
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>900 µs ± 28.2 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> religion.melt(id_vars = 'religion', var_name = 'income', value_name = 'count')
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>990 µs ± 24.5 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://grantmcdermott.com/reshape-benchmarks/">Sample data</a>, using 1000 columns (you can personally increase the number of columns to 1e6 or 1e8, depending on the power of your CPU):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sparse_wide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'Data_files/sparse-wide.csv'</span><span class="p">)</span>
<span class="n">sparse_wide</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>grp</th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>x4</th>
      <th>x5</th>
      <th>x6</th>
      <th>x7</th>
      <th>x8</th>
      <th>...</th>
      <th>x991</th>
      <th>x992</th>
      <th>x993</th>
      <th>x994</th>
      <th>x995</th>
      <th>x996</th>
      <th>x997</th>
      <th>x998</th>
      <th>x999</th>
      <th>x1000</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1000</td>
      <td>A</td>
      <td>I</td>
      <td>A</td>
      <td>M</td>
      <td>O</td>
      <td>E</td>
      <td>F</td>
      <td>D</td>
      <td>...</td>
      <td>C</td>
      <td>L</td>
      <td>G</td>
      <td>I</td>
      <td>R</td>
      <td>X</td>
      <td>O</td>
      <td>W</td>
      <td>L</td>
      <td>L</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>528</td>
      <td>I</td>
      <td>X</td>
      <td>U</td>
      <td>Q</td>
      <td>B</td>
      <td>X</td>
      <td>I</td>
      <td>J</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>151</td>
      <td>J</td>
      <td>Q</td>
      <td>H</td>
      <td>F</td>
      <td>B</td>
      <td>X</td>
      <td>B</td>
      <td>F</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>343</td>
      <td>P</td>
      <td>A</td>
      <td>K</td>
      <td>K</td>
      <td>N</td>
      <td>R</td>
      <td>E</td>
      <td>E</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>460</td>
      <td>L</td>
      <td>D</td>
      <td>G</td>
      <td>X</td>
      <td>I</td>
      <td>O</td>
      <td>C</td>
      <td>W</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1002 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> sparse_wide.melt(id_vars = ['id', 'grp'])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>32.4 ms ± 637 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> sparse_wide.pivot_longer(index = ['id', 'grp'])
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>29 ms ± 749 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's test on the <code>movies</code> dataset:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span>
            <span class="n">movies</span><span class="p">,</span> 
            <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">'director'</span><span class="p">,</span> <span class="s1">'director_fb_likes'</span><span class="p">,</span> <span class="s1">'actor'</span><span class="p">,</span> <span class="s1">'actor_fb_likes'</span><span class="p">],</span> 
            <span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'rating'</span><span class="p">,</span> <span class="s1">'year'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">],</span> 
            <span class="n">j</span> <span class="o">=</span> <span class="s1">'num'</span><span class="p">,</span> 
            <span class="n">sep</span><span class="o">=</span><span class="s1">'_'</span><span class="p">)</span>
<span class="n">wl</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>director</th>
      <th>director_fb_likes</th>
      <th>actor</th>
      <th>actor_fb_likes</th>
    </tr>
    <tr>
      <th>title</th>
      <th>rating</th>
      <th>year</th>
      <th>duration</th>
      <th>num</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Avatar</th>
      <th rowspan="3" valign="top">PG-13</th>
      <th rowspan="3" valign="top">2009.0</th>
      <th rowspan="3" valign="top">178.0</th>
      <th>1</th>
      <td>James Cameron</td>
      <td>0.0</td>
      <td>CCH Pounder</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Joel David Moore</td>
      <td>936.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Wes Studi</td>
      <td>855.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Pirates of the Caribbean: At World's End</th>
      <th rowspan="2" valign="top">PG-13</th>
      <th rowspan="2" valign="top">2007.0</th>
      <th rowspan="2" valign="top">169.0</th>
      <th>1</th>
      <td>Gore Verbinski</td>
      <td>563.0</td>
      <td>Johnny Depp</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Orlando Bloom</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Shanghai Calling</th>
      <th rowspan="2" valign="top">PG-13</th>
      <th rowspan="2" valign="top">2012.0</th>
      <th rowspan="2" valign="top">100.0</th>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Daniel Henney</td>
      <td>719.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Eliza Coupe</td>
      <td>490.0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">My Date with Drew</th>
      <th rowspan="3" valign="top">PG</th>
      <th rowspan="3" valign="top">2004.0</th>
      <th rowspan="3" valign="top">90.0</th>
      <th>1</th>
      <td>Jon Gunn</td>
      <td>16.0</td>
      <td>John August</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Brian Herzlinger</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jon Gunn</td>
      <td>16.0</td>
    </tr>
  </tbody>
</table>
<p>14748 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">movies</span>
        <span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">),</span>
            <span class="n">names_to</span> <span class="o">=</span> <span class="s2">".value"</span><span class="p">,</span>
            <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(.+)_\d"</span><span class="p">,</span>
            <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>

<span class="n">out</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>rating</th>
      <th>year</th>
      <th>duration</th>
      <th>director</th>
      <th>director_fb_likes</th>
      <th>actor</th>
      <th>actor_fb_likes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Avatar</td>
      <td>PG-13</td>
      <td>2009.0</td>
      <td>178.0</td>
      <td>James Cameron</td>
      <td>0.0</td>
      <td>CCH Pounder</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Avatar</td>
      <td>PG-13</td>
      <td>2009.0</td>
      <td>178.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Joel David Moore</td>
      <td>936.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Avatar</td>
      <td>PG-13</td>
      <td>2009.0</td>
      <td>178.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Wes Studi</td>
      <td>855.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>PG-13</td>
      <td>2007.0</td>
      <td>169.0</td>
      <td>Gore Verbinski</td>
      <td>563.0</td>
      <td>Johnny Depp</td>
      <td>40000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Pirates of the Caribbean: At World's End</td>
      <td>PG-13</td>
      <td>2007.0</td>
      <td>169.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Orlando Bloom</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>14743</th>
      <td>Shanghai Calling</td>
      <td>PG-13</td>
      <td>2012.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Daniel Henney</td>
      <td>719.0</td>
    </tr>
    <tr>
      <th>14744</th>
      <td>Shanghai Calling</td>
      <td>PG-13</td>
      <td>2012.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Eliza Coupe</td>
      <td>490.0</td>
    </tr>
    <tr>
      <th>14745</th>
      <td>My Date with Drew</td>
      <td>PG</td>
      <td>2004.0</td>
      <td>90.0</td>
      <td>Jon Gunn</td>
      <td>16.0</td>
      <td>John August</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>14746</th>
      <td>My Date with Drew</td>
      <td>PG</td>
      <td>2004.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Brian Herzlinger</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>14747</th>
      <td>My Date with Drew</td>
      <td>PG</td>
      <td>2004.0</td>
      <td>90.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jon Gunn</td>
      <td>16.0</td>
    </tr>
  </tbody>
</table>
<p>14748 rows × 8 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A more efficient approach than <code>pd.wide_to_long</code>, using <code>pd.stack</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'rating'</span><span class="p">,</span> <span class="s1">'year'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">]</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">vid</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">"_"</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">vid</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">'num'</span><span class="p">]</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">level</span> <span class="o">=</span> <span class="s1">'num'</span><span class="p">,</span> <span class="n">dropna</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">vid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>actor</th>
      <th>actor_fb_likes</th>
      <th>director</th>
      <th>director_fb_likes</th>
    </tr>
    <tr>
      <th>title</th>
      <th>rating</th>
      <th>year</th>
      <th>duration</th>
      <th>num</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Avatar</th>
      <th rowspan="3" valign="top">PG-13</th>
      <th rowspan="3" valign="top">2009.0</th>
      <th rowspan="3" valign="top">178.0</th>
      <th>1</th>
      <td>CCH Pounder</td>
      <td>1000.0</td>
      <td>James Cameron</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Joel David Moore</td>
      <td>936.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wes Studi</td>
      <td>855.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Pirates of the Caribbean: At World's End</th>
      <th rowspan="2" valign="top">PG-13</th>
      <th rowspan="2" valign="top">2007.0</th>
      <th rowspan="2" valign="top">169.0</th>
      <th>1</th>
      <td>Johnny Depp</td>
      <td>40000.0</td>
      <td>Gore Verbinski</td>
      <td>563.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Orlando Bloom</td>
      <td>5000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Shanghai Calling</th>
      <th rowspan="2" valign="top">PG-13</th>
      <th rowspan="2" valign="top">2012.0</th>
      <th rowspan="2" valign="top">100.0</th>
      <th>2</th>
      <td>Daniel Henney</td>
      <td>719.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eliza Coupe</td>
      <td>490.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">My Date with Drew</th>
      <th rowspan="3" valign="top">PG</th>
      <th rowspan="3" valign="top">2004.0</th>
      <th rowspan="3" valign="top">90.0</th>
      <th>1</th>
      <td>John August</td>
      <td>86.0</td>
      <td>Jon Gunn</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Brian Herzlinger</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jon Gunn</td>
      <td>16.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>14748 rows × 4 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wl</span> <span class="o">=</span> <span class="n">wl</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">'num'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">wl</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vid</span> <span class="o">=</span> <span class="p">(</span><span class="n">vid</span>
        <span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">'num'</span><span class="p">)</span>
        <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">'director'</span><span class="p">,</span> <span class="s1">'director_fb_likes'</span><span class="p">,</span> <span class="s1">'actor'</span><span class="p">,</span> <span class="s1">'actor_fb_likes'</span><span class="p">]]</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="p">)</span>

<span class="n">wl</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">vid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vid</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it 
<span class="n">pd</span><span class="o">.</span><span class="n">wide_to_long</span><span class="p">(</span>
    <span class="n">movies</span><span class="p">,</span> 
    <span class="n">stubnames</span><span class="o">=</span><span class="p">[</span><span class="s1">'director'</span><span class="p">,</span> <span class="s1">'director_fb_likes'</span><span class="p">,</span> <span class="s1">'actor'</span><span class="p">,</span> <span class="s1">'actor_fb_likes'</span><span class="p">],</span> 
    <span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'rating'</span><span class="p">,</span> <span class="s1">'year'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">],</span> 
    <span class="n">j</span> <span class="o">=</span> <span class="s1">'num'</span><span class="p">,</span> 
    <span class="n">sep</span><span class="o">=</span><span class="s1">'_'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>144 ms ± 3.32 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'rating'</span><span class="p">,</span> <span class="s1">'year'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">]</span>
<span class="n">vid</span> <span class="o">=</span> <span class="n">movies</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">vid</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">vid</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s2">"_"</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">vid</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">level</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dropna</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>15.1 ms ± 130 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="p">(</span><span class="n">movies</span>
<span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">),</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="s2">".value"</span><span class="p">,</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"(.+)_\d"</span><span class="p">,</span>
    <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>8.44 ms ± 156 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>it
<span class="n">movies</span><span class="o">.</span><span class="n">pivot_longer</span><span class="p">(</span>
    <span class="n">index</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">'title'</span><span class="p">,</span> <span class="s1">'duration'</span><span class="p">),</span>
    <span class="n">names_to</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'director'</span><span class="p">,</span> <span class="s1">'director_fb_likes'</span><span class="p">,</span> <span class="s1">'actor'</span><span class="p">,</span> <span class="s1">'actor_fb_likes'</span><span class="p">],</span>
    <span class="n">names_pattern</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'director_\d$'</span><span class="p">,</span> <span class="s1">'director_fb_likes'</span><span class="p">,</span> <span class="s1">'actor_\d$'</span><span class="p">,</span> <span class="s1">'actor.+'</span><span class="p">],</span>
    <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>7.94 ms ± 287 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Your mileage may vary with these speed tests.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summary">
<a class="anchor" href="#Summary" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Summary</strong><a class="anchor-link" href="#Summary"> </a>
</h3>
<p>This blog post showed various ways to reshape data into long form, using <code>pivot_longer</code>, based on some common patterns. Once the pattern is identified, use the appropriate syntax for <code>pivot_longer</code>. It is meant to be simple, straightforward, and efficient.</p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="samukweku/data-wrangling-blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/data-wrangling-blog/python/pandas/reshape/wide-to-long/pivot_longer/stack/2022/09/08/Pivot_longer-Reshape-Data-in-Pandas-with-Ease-From-Wide-to-Long.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/data-wrangling-blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/data-wrangling-blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/data-wrangling-blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Data Wrangling Blog.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/samukweku" target="_blank" title="samukweku"><svg class="svg-icon grey"><use xlink:href="/data-wrangling-blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/samukweku" target="_blank" title="samukweku"><svg class="svg-icon grey"><use xlink:href="/data-wrangling-blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
